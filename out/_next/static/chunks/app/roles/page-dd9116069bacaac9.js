(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[550],{2442:function(e,s,t){"use strict";t.d(s,{Z:function(){return i}});var r=t(5531);/**
 * @license lucide-react v0.446.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let i=(0,r.Z)("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]])},227:function(e,s,t){Promise.resolve().then(t.bind(t,1983))},1983:function(e,s,t){"use strict";t.r(s),t.d(s,{default:function(){return N}});var r=t(7437),i=t(2265),n=t(4033),l=t(9155),a=t(3023),c=t(6110),d=t(2609),o=t(1908),u=t(2553),x=t(7749),h=t(6672),f=t(5771),m=t(220),p=t(2621),j=t(3518),v=t(164),b=t(1280),g=t(5668);function N(){let{user:e,isLoading:s}=(0,m.useAuth)(),{toast:t}=(0,p.pm)(),N=(0,n.useRouter)(),[y,k]=(0,i.useState)(!1),[w,C]=(0,i.useState)([]),[R,S]=(0,i.useState)(!0),[E,_]=(0,i.useState)(!1),[z,A]=(0,i.useState)(!1),[D,Z]=(0,i.useState)("add"),[P,O]=(0,i.useState)(""),[M,I]=(0,i.useState)(""),[V,q]=(0,i.useState)([]),[X,B]=(0,i.useState)([]),[K,L]=(0,i.useState)(null),[W,$]=(0,i.useState)(null);(0,i.useEffect)(()=>{s||e||N.push("/login")},[e,s,N]),(0,i.useEffect)(()=>{let s=async()=>{try{let e=await (0,v.vd)();C(e)}catch(e){t({title:"Error",description:e.message,variant:"destructive"})}finally{S(!1)}},r=async()=>{try{let e=await (0,v.qg)();B(e)}catch(e){t({title:"Error",description:e.message,variant:"destructive"})}};if(e&&e.permissions){let t=e.permissions.includes("all_permissions")||e.permissions.includes("manage_roles");k(t),t?(s(),r()):S(!1)}},[e,t]);let H=async()=>{if(""===P.trim()||0===V.length){t({title:"Error",description:"Role name and at least one permission are required",variant:"destructive"});return}try{let e={name:P,description:M,permissions:V};if("add"===D){await (0,v.fA)(e);let s=await (0,v.vd)();C(s),t({title:"Success",description:"Role created successfully"})}else if(null==K?void 0:K.id){await (0,v.ul)(K.id.toString(),e);let s=await (0,v.vd)();C(s),t({title:"Success",description:"Role updated successfully"})}F()}catch(e){t({title:"Error",description:e.message,variant:"destructive"})}},T=async e=>{if(confirm("Are you sure you want to delete this role?"))try{await (0,v.Rd)(e.toString()),C(w.filter(s=>s.id!==e)),t({title:"Success",description:"Role deleted successfully"})}catch(e){t({title:"Error",description:e.message,variant:"destructive"})}},Y=e=>{Z("edit"),L(e),O(e.name),I(e.description||""),q(e.permissions),_(!0)},U=e=>{$(e),A(!0)},F=()=>{_(!1),O(""),I(""),q([]),L(null),Z("add")},G=(e,s)=>{s?q([...V,e]):q(V.filter(s=>s!==e))},J=(e,s)=>{if(s){let s=[...V,...e],t=Array.from(new Set(s));q(t)}else q(V.filter(s=>!e.includes(s)))},Q=e=>{e?q(X):q([])},ee=e=>e.every(e=>V.includes(e));if(s||R)return(0,r.jsx)(j.Z,{children:(0,r.jsxs)("div",{className:"space-y-8",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h2",{className:"text-3xl font-bold tracking-tight",children:"Roles"}),(0,r.jsx)("p",{className:"text-muted-foreground",children:"Manage user roles"})]}),(0,r.jsx)(c.Zb,{children:(0,r.jsx)(c.aY,{className:"pt-6",children:(0,r.jsx)(b.g,{})})})]})});if(!y)return(0,r.jsx)(j.Z,{children:(0,r.jsx)(g.Z,{})});let es=(()=>{let e={};return X.filter(e=>"all_permissions"!==e).forEach(s=>{let t=s.split("_"),r=t.slice(1).join("_");r&&(e[r]||(e[r]=[]),e[r].push(s))}),e})();return(0,r.jsx)(j.Z,{children:(0,r.jsxs)("div",{className:"space-y-8",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h2",{className:"text-3xl font-bold tracking-tight",children:"Roles"}),(0,r.jsx)("p",{className:"text-muted-foreground",children:"Manage user roles"})]}),(0,r.jsx)(a.z,{onClick:()=>{Z("add"),O(""),I(""),q([]),L(null),_(!0)},className:"bg-[#6B46C1] hover:bg-[#5a3aa3]",children:"Add Role"})]}),(0,r.jsxs)(c.Zb,{children:[(0,r.jsx)(c.Ol,{children:(0,r.jsx)(c.ll,{children:"All Roles"})}),(0,r.jsx)(c.aY,{children:0===w.length?(0,r.jsx)("p",{children:"No roles found."}):(0,r.jsx)("div",{className:"overflow-x-auto",children:(0,r.jsxs)(u.iA,{children:[(0,r.jsx)(u.xD,{children:(0,r.jsxs)(u.SC,{children:[(0,r.jsx)(u.ss,{className:"hidden md:table-cell",children:"ID"}),(0,r.jsx)(u.ss,{children:"Name"}),(0,r.jsx)(u.ss,{className:"hidden md:table-cell",children:"Description"}),(0,r.jsx)(u.ss,{children:"Permissions"}),(0,r.jsx)(u.ss,{children:"Actions"})]})}),(0,r.jsx)(u.RM,{children:w.map(e=>(0,r.jsxs)(u.SC,{className:"cursor-pointer",onClick:()=>U(e),children:[(0,r.jsx)(u.pj,{className:"hidden md:table-cell font-medium",children:e.id}),(0,r.jsx)(u.pj,{className:"font-medium",children:e.name}),(0,r.jsx)(u.pj,{className:"hidden md:table-cell max-w-[200px] truncate",children:e.description||"-"}),(0,r.jsx)(u.pj,{children:(0,r.jsxs)(l.C,{variant:"secondary",children:[e.permissions.length," permissions"]})}),(0,r.jsx)(u.pj,{onClick:e=>e.stopPropagation(),children:(0,r.jsxs)("div",{className:"flex gap-2",children:[(0,r.jsx)(a.z,{variant:"outline",size:"sm",onClick:()=>Y(e),children:"Edit"}),(0,r.jsx)(a.z,{variant:"destructive",size:"sm",onClick:()=>T(e.id),children:"Delete"})]})})]},e.id))})]})})})]}),(0,r.jsx)(d.Vq,{open:E,onOpenChange:e=>{_(e),e||F()},children:(0,r.jsxs)(d.cZ,{className:"max-w-lg max-h-[80vh] overflow-y-auto",children:[(0,r.jsx)(d.fK,{children:(0,r.jsx)(d.$N,{children:"add"===D?"Add New Role":"Edit Role"})}),(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)(h._,{children:"Role Name"}),(0,r.jsx)(o.I,{placeholder:"Role Name",value:P,onChange:e=>O(e.target.value)})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)(h._,{children:"Description"}),(0,r.jsx)(f.g,{placeholder:"Role Description",value:M,onChange:e=>I(e.target.value),rows:3})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)(h._,{className:"text-sm font-medium mb-2 block",children:"Permissions"}),(0,r.jsxs)("div",{className:"max-h-64 overflow-y-auto border rounded-md p-3",children:[(0,r.jsx)("div",{className:"border-b pb-2 mb-2",children:(0,r.jsxs)("label",{className:"flex items-center space-x-2",children:[(0,r.jsx)(x.X,{checked:X.every(e=>V.includes(e)),onCheckedChange:e=>Q(e)}),(0,r.jsx)("span",{className:"text-sm font-medium",children:"All Permissions"})]})}),Object.entries(es).map(e=>{let[s,t]=e;return(0,r.jsxs)("div",{className:"border-b pb-2 mb-2 last:border-b-0",children:[(0,r.jsxs)("label",{className:"flex items-center space-x-2 mb-1",children:[(0,r.jsx)(x.X,{checked:ee(t),onCheckedChange:e=>J(t,e)}),(0,r.jsx)("span",{className:"text-sm font-medium capitalize",children:s})]}),(0,r.jsx)("div",{className:"ml-6 flex flex-wrap gap-2",children:t.map(e=>(0,r.jsxs)("label",{className:"flex items-center space-x-2",children:[(0,r.jsx)(x.X,{checked:V.includes(e),onCheckedChange:s=>G(e,s)}),(0,r.jsx)("span",{className:"text-xs",children:e.split("_")[0]})]},e))})]},s)})]})]})]}),(0,r.jsx)(d.cN,{children:(0,r.jsx)(a.z,{onClick:H,className:"bg-[#6B46C1] hover:bg-[#5a3aa3]",children:"add"===D?"Save Role":"Update Role"})})]})}),(0,r.jsx)(d.Vq,{open:z,onOpenChange:A,children:(0,r.jsxs)(d.cZ,{className:"max-w-[90vw] sm:max-w-lg md:max-w-xl max-h-[80vh] overflow-y-auto",children:[(0,r.jsx)(d.fK,{children:(0,r.jsx)(d.$N,{children:"View Role"})}),W&&(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)(h._,{className:"font-semibold",children:"ID:"}),(0,r.jsx)("p",{className:"text-sm",children:W.id})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)(h._,{className:"font-semibold",children:"Name:"}),(0,r.jsx)("p",{className:"text-sm",children:W.name})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)(h._,{className:"font-semibold",children:"Description:"}),(0,r.jsx)("p",{className:"text-sm",children:W.description||"N/A"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)(h._,{className:"font-semibold",children:"Permissions:"}),(0,r.jsx)("div",{className:"flex flex-wrap gap-2 mt-2",children:W.permissions.map(e=>(0,r.jsx)(l.C,{variant:"outline",className:"text-xs",children:e},e))})]})]}),(0,r.jsx)(d.cN,{children:(0,r.jsx)(a.z,{variant:"outline",onClick:()=>A(!1),children:"Close"})})]})})]})})}},9155:function(e,s,t){"use strict";t.d(s,{C:function(){return a}});var r=t(7437);t(2265);var i=t(9213),n=t(9311);let l=(0,i.j)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function a(e){let{className:s,variant:t,...i}=e;return(0,r.jsx)("div",{className:(0,n.cn)(l({variant:t}),s),...i})}},7749:function(e,s,t){"use strict";t.d(s,{X:function(){return c}});var r=t(7437),i=t(2265),n=t(6062),l=t(2442),a=t(9311);let c=i.forwardRef((e,s)=>{let{className:t,...i}=e;return(0,r.jsx)(n.fC,{ref:s,className:(0,a.cn)("peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",t),...i,children:(0,r.jsx)(n.z$,{className:(0,a.cn)("flex items-center justify-center text-current"),children:(0,r.jsx)(l.Z,{className:"h-4 w-4"})})})});c.displayName=n.fC.displayName},5771:function(e,s,t){"use strict";t.d(s,{g:function(){return l}});var r=t(7437),i=t(2265),n=t(9311);let l=i.forwardRef((e,s)=>{let{className:t,...i}=e;return(0,r.jsx)("textarea",{className:(0,n.cn)("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",t),ref:s,...i})});l.displayName="Textarea"},6062:function(e,s,t){"use strict";t.d(s,{fC:function(){return w},z$:function(){return C}});var r=t(2265),i=t(2210),n=t(6989),l=t(5744),a=t(3763),c=t(5184),d=t(4977),o=t(5606),u=t(9381),x=t(7437),h="Checkbox",[f,m]=(0,n.b)(h),[p,j]=f(h),v=r.forwardRef((e,s)=>{let{__scopeCheckbox:t,name:n,checked:c,defaultChecked:d,required:o,disabled:h,value:f="on",onCheckedChange:m,form:j,...v}=e,[b,g]=r.useState(null),w=(0,i.e)(s,e=>g(e)),C=r.useRef(!1),R=!b||j||!!b.closest("form"),[S=!1,E]=(0,a.T)({prop:c,defaultProp:d,onChange:m}),_=r.useRef(S);return r.useEffect(()=>{let e=b?.form;if(e){let s=()=>E(_.current);return e.addEventListener("reset",s),()=>e.removeEventListener("reset",s)}},[b,E]),(0,x.jsxs)(p,{scope:t,state:S,disabled:h,children:[(0,x.jsx)(u.WV.button,{type:"button",role:"checkbox","aria-checked":y(S)?"mixed":S,"aria-required":o,"data-state":k(S),"data-disabled":h?"":void 0,disabled:h,value:f,...v,ref:w,onKeyDown:(0,l.M)(e.onKeyDown,e=>{"Enter"===e.key&&e.preventDefault()}),onClick:(0,l.M)(e.onClick,e=>{E(e=>!!y(e)||!e),R&&(C.current=e.isPropagationStopped(),C.current||e.stopPropagation())})}),R&&(0,x.jsx)(N,{control:b,bubbles:!C.current,name:n,value:f,checked:S,required:o,disabled:h,form:j,style:{transform:"translateX(-100%)"},defaultChecked:!y(d)&&d})]})});v.displayName=h;var b="CheckboxIndicator",g=r.forwardRef((e,s)=>{let{__scopeCheckbox:t,forceMount:r,...i}=e,n=j(b,t);return(0,x.jsx)(o.z,{present:r||y(n.state)||!0===n.state,children:(0,x.jsx)(u.WV.span,{"data-state":k(n.state),"data-disabled":n.disabled?"":void 0,...i,ref:s,style:{pointerEvents:"none",...e.style}})})});g.displayName=b;var N=e=>{let{control:s,checked:t,bubbles:i=!0,defaultChecked:n,...l}=e,a=r.useRef(null),o=(0,c.D)(t),u=(0,d.t)(s);r.useEffect(()=>{let e=a.current,s=window.HTMLInputElement.prototype,r=Object.getOwnPropertyDescriptor(s,"checked"),n=r.set;if(o!==t&&n){let s=new Event("click",{bubbles:i});e.indeterminate=y(t),n.call(e,!y(t)&&t),e.dispatchEvent(s)}},[o,t,i]);let h=r.useRef(!y(t)&&t);return(0,x.jsx)("input",{type:"checkbox","aria-hidden":!0,defaultChecked:n??h.current,...l,tabIndex:-1,ref:a,style:{...e.style,...u,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})};function y(e){return"indeterminate"===e}function k(e){return y(e)?"indeterminate":e?"checked":"unchecked"}var w=v,C=g},5184:function(e,s,t){"use strict";t.d(s,{D:function(){return i}});var r=t(2265);function i(e){let s=r.useRef({value:e,previous:e});return r.useMemo(()=>(s.current.value!==e&&(s.current.previous=s.current.value,s.current.value=e),s.current.previous),[e])}},4977:function(e,s,t){"use strict";t.d(s,{t:function(){return n}});var r=t(2265),i=t(1030);function n(e){let[s,t]=r.useState(void 0);return(0,i.b)(()=>{if(e){t({width:e.offsetWidth,height:e.offsetHeight});let s=new ResizeObserver(s=>{let r,i;if(!Array.isArray(s)||!s.length)return;let n=s[0];if("borderBoxSize"in n){let e=n.borderBoxSize,s=Array.isArray(e)?e[0]:e;r=s.inlineSize,i=s.blockSize}else r=e.offsetWidth,i=e.offsetHeight;t({width:r,height:i})});return s.observe(e,{box:"border-box"}),()=>s.unobserve(e)}t(void 0)},[e]),s}}},function(e){e.O(0,[141,303,51,45,80,971,864,744],function(){return e(e.s=227)}),_N_E=e.O()}]);