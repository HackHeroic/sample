(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[111],{9326:function(e,s,i){Promise.resolve().then(i.bind(i,9))},9:function(e,s,i){"use strict";i.r(s),i.d(s,{default:function(){return N}});var n=i(7437),t=i(2265),r=i(4033),a=i(3023),l=i(6110),c=i(2609),d=i(1908),o=i(2553),m=i(6672),h=i(5771),u=i(220),x=i(2621),j=i(3518),p=i(164),f=i(1280),g=i(5668),v=i(2601);function N(){let{user:e,isLoading:s}=(0,u.useAuth)(),{toast:i}=(0,x.pm)(),N=(0,r.useRouter)(),[b,P]=(0,t.useState)(!1),[y,_]=(0,t.useState)([]),[w,C]=(0,t.useState)(!0),[S,k]=(0,t.useState)(!1),[A,E]=(0,t.useState)(!1),[I,z]=(0,t.useState)("add"),[B,D]=(0,t.useState)(""),[Z,L]=(0,t.useState)(""),[U,R]=(0,t.useState)(null),[O,T]=(0,t.useState)(null);(0,t.useEffect)(()=>{s||e||N.push("/login")},[e,s,N]),(0,t.useEffect)(()=>{let s=async()=>{try{let e=await fetch("".concat(v.env.NEXT_PUBLIC_API_URL,"/permissions"),{headers:{Authorization:"Bearer ".concat(localStorage.getItem("token"))}}),s=await e.json();_(s)}catch(e){i({title:"Error",description:e.message,variant:"destructive"})}finally{C(!1)}};if(e&&e.permissions){let i=e.permissions.includes("all_permissions")||e.permissions.includes("manage_permissions");P(i),i?s():C(!1)}},[e,i]);let q=async()=>{if(""===B.trim()){i({title:"Error",description:"Permission name is required",variant:"destructive"});return}try{let e={name:B,description:Z};if("add"===I){await (0,p.J$)(e);let s=await fetch("".concat(v.env.NEXT_PUBLIC_API_URL,"/permissions"),{headers:{Authorization:"Bearer ".concat(localStorage.getItem("token"))}}),n=await s.json();_(n),i({title:"Success",description:"Permission created successfully"})}else if(null==U?void 0:U.id){await (0,p.kY)(U.id.toString(),e);let s=await fetch("".concat(v.env.NEXT_PUBLIC_API_URL,"/permissions"),{headers:{Authorization:"Bearer ".concat(localStorage.getItem("token"))}}),n=await s.json();_(n),i({title:"Success",description:"Permission updated successfully"})}Y()}catch(e){i({title:"Error",description:e.message,variant:"destructive"})}},M=async e=>{if(confirm("Are you sure you want to delete this permission?"))try{await (0,p.g1)(e.toString()),_(y.filter(s=>s.id!==e)),i({title:"Success",description:"Permission deleted successfully"})}catch(e){i({title:"Error",description:e.message,variant:"destructive"})}},V=e=>{z("edit"),R(e),D(e.name),L(e.description||""),k(!0)},X=e=>{T(e),E(!0)},Y=()=>{k(!1),D(""),L(""),R(null),z("add")};return s||w?(0,n.jsx)(j.Z,{children:(0,n.jsxs)("div",{className:"space-y-8",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("h2",{className:"text-3xl font-bold tracking-tight",children:"Permissions"}),(0,n.jsx)("p",{className:"text-muted-foreground",children:"Manage system permissions"})]}),(0,n.jsx)(l.Zb,{children:(0,n.jsx)(l.aY,{className:"pt-6",children:(0,n.jsx)(f.g,{})})})]})}):b?(0,n.jsx)(j.Z,{children:(0,n.jsxs)("div",{className:"space-y-8",children:[(0,n.jsxs)("div",{className:"flex justify-between items-center",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("h2",{className:"text-3xl font-bold tracking-tight",children:"Permissions"}),(0,n.jsx)("p",{className:"text-muted-foreground",children:"Manage system permissions"})]}),(0,n.jsx)(a.z,{onClick:()=>{z("add"),D(""),L(""),R(null),k(!0)},className:"bg-[#6B46C1] hover:bg-[#5a3aa3]",children:"Add Permission"})]}),(0,n.jsxs)(l.Zb,{children:[(0,n.jsx)(l.Ol,{children:(0,n.jsx)(l.ll,{children:"All Permissions"})}),(0,n.jsx)(l.aY,{children:0===y.length?(0,n.jsx)("p",{children:"No permissions found."}):(0,n.jsx)("div",{className:"overflow-x-auto",children:(0,n.jsxs)(o.iA,{children:[(0,n.jsx)(o.xD,{children:(0,n.jsxs)(o.SC,{children:[(0,n.jsx)(o.ss,{className:"hidden md:table-cell",children:"ID"}),(0,n.jsx)(o.ss,{children:"Name"}),(0,n.jsx)(o.ss,{className:"hidden md:table-cell",children:"Description"}),(0,n.jsx)(o.ss,{children:"Actions"})]})}),(0,n.jsx)(o.RM,{children:y.map(e=>(0,n.jsxs)(o.SC,{className:"cursor-pointer",onClick:()=>X(e),children:[(0,n.jsx)(o.pj,{className:"hidden md:table-cell font-medium",children:e.id}),(0,n.jsx)(o.pj,{className:"font-medium",children:e.name}),(0,n.jsx)(o.pj,{className:"hidden md:table-cell max-w-[300px] truncate",children:e.description||"-"}),(0,n.jsx)(o.pj,{onClick:e=>e.stopPropagation(),children:(0,n.jsxs)("div",{className:"flex gap-2",children:[(0,n.jsx)(a.z,{variant:"outline",size:"sm",onClick:()=>V(e),children:"Edit"}),(0,n.jsx)(a.z,{variant:"destructive",size:"sm",onClick:()=>M(e.id),children:"Delete"})]})})]},e.id))})]})})})]}),(0,n.jsx)(c.Vq,{open:S,onOpenChange:e=>{k(e),e||Y()},children:(0,n.jsxs)(c.cZ,{children:[(0,n.jsx)(c.fK,{children:(0,n.jsx)(c.$N,{children:"add"===I?"Add New Permission":"Edit Permission"})}),(0,n.jsxs)("div",{className:"space-y-4",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)(m._,{children:"Permission Name"}),(0,n.jsx)(d.I,{placeholder:"Permission Name",value:B,onChange:e=>D(e.target.value)})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)(m._,{children:"Description"}),(0,n.jsx)(h.g,{placeholder:"Permission Description",value:Z,onChange:e=>L(e.target.value),rows:3})]})]}),(0,n.jsx)(c.cN,{children:(0,n.jsx)(a.z,{onClick:q,className:"bg-[#6B46C1] hover:bg-[#5a3aa3]",children:"add"===I?"Save Permission":"Update Permission"})})]})}),(0,n.jsx)(c.Vq,{open:A,onOpenChange:E,children:(0,n.jsxs)(c.cZ,{children:[(0,n.jsx)(c.fK,{children:(0,n.jsx)(c.$N,{children:"View Permission"})}),O&&(0,n.jsxs)("div",{className:"space-y-4",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)(m._,{className:"font-semibold",children:"ID:"}),(0,n.jsx)("p",{className:"text-sm",children:O.id})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)(m._,{className:"font-semibold",children:"Name:"}),(0,n.jsx)("p",{className:"text-sm",children:O.name})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)(m._,{className:"font-semibold",children:"Description:"}),(0,n.jsx)("p",{className:"text-sm",children:O.description||"N/A"})]})]}),(0,n.jsx)(c.cN,{children:(0,n.jsx)(a.z,{variant:"outline",onClick:()=>E(!1),children:"Close"})})]})})]})}):(0,n.jsx)(j.Z,{children:(0,n.jsx)(g.Z,{})})}},5771:function(e,s,i){"use strict";i.d(s,{g:function(){return a}});var n=i(7437),t=i(2265),r=i(9311);let a=t.forwardRef((e,s)=>{let{className:i,...t}=e;return(0,n.jsx)("textarea",{className:(0,r.cn)("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",i),ref:s,...t})});a.displayName="Textarea"}},function(e){e.O(0,[141,303,51,45,80,971,864,744],function(){return e(e.s=9326)}),_N_E=e.O()}]);