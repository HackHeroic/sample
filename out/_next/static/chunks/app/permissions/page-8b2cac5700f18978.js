(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[111],{7648:function(e,s,i){Promise.resolve().then(i.bind(i,9))},9:function(e,s,i){"use strict";i.r(s),i.d(s,{default:function(){return v}});var n=i(7437),t=i(2265),r=i(4033),a=i(3023),l=i(6110),c=i(2609),d=i(1908),o=i(2553),h=i(6672),m=i(5771),u=i(220),x=i(2621),j=i(3518),p=i(164),f=i(1280),g=i(5668);function v(){let{user:e,isLoading:s}=(0,u.useAuth)(),{toast:i}=(0,x.pm)(),v=(0,r.useRouter)(),[N,b]=(0,t.useState)(!1),[y,w]=(0,t.useState)([]),[S,k]=(0,t.useState)(!0),[C,P]=(0,t.useState)(!1),[_,A]=(0,t.useState)(!1),[E,z]=(0,t.useState)("add"),[D,Z]=(0,t.useState)(""),[I,B]=(0,t.useState)(""),[O,q]=(0,t.useState)(null),[M,R]=(0,t.useState)(null);(0,t.useEffect)(()=>{s||e||v.push("/login")},[e,s,v]),(0,t.useEffect)(()=>{let s=async()=>{try{let e=await fetch("".concat("http://localhost:4000","/permissions"),{headers:{Authorization:"Bearer ".concat(localStorage.getItem("token"))}}),s=await e.json();w(s)}catch(e){i({title:"Error",description:e.message,variant:"destructive"})}finally{k(!1)}};if(e&&e.permissions){let i=e.permissions.includes("all_permissions")||e.permissions.includes("manage_permissions");b(i),i?s():k(!1)}},[e,i]);let V=async()=>{if(""===D.trim()){i({title:"Error",description:"Permission name is required",variant:"destructive"});return}try{let e={name:D,description:I};if("add"===E){await (0,p.J$)(e);let s=await fetch("".concat("http://localhost:4000","/permissions"),{headers:{Authorization:"Bearer ".concat(localStorage.getItem("token"))}}),n=await s.json();w(n),i({title:"Success",description:"Permission created successfully"})}else if(null==O?void 0:O.id){await (0,p.kY)(O.id.toString(),e);let s=await fetch("".concat("http://localhost:4000","/permissions"),{headers:{Authorization:"Bearer ".concat(localStorage.getItem("token"))}}),n=await s.json();w(n),i({title:"Success",description:"Permission updated successfully"})}J()}catch(e){i({title:"Error",description:e.message,variant:"destructive"})}},Y=async e=>{if(confirm("Are you sure you want to delete this permission?"))try{await (0,p.g1)(e.toString()),w(y.filter(s=>s.id!==e)),i({title:"Success",description:"Permission deleted successfully"})}catch(e){i({title:"Error",description:e.message,variant:"destructive"})}},$=e=>{z("edit"),q(e),Z(e.name),B(e.description||""),P(!0)},K=e=>{R(e),A(!0)},J=()=>{P(!1),Z(""),B(""),q(null),z("add")};return s||S?(0,n.jsx)(j.Z,{children:(0,n.jsxs)("div",{className:"space-y-8",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("h2",{className:"text-3xl font-bold tracking-tight",children:"Permissions"}),(0,n.jsx)("p",{className:"text-muted-foreground",children:"Manage system permissions"})]}),(0,n.jsx)(l.Zb,{children:(0,n.jsx)(l.aY,{className:"pt-6",children:(0,n.jsx)(f.g,{})})})]})}):N?(0,n.jsx)(j.Z,{children:(0,n.jsxs)("div",{className:"space-y-8",children:[(0,n.jsxs)("div",{className:"flex justify-between items-center",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("h2",{className:"text-3xl font-bold tracking-tight",children:"Permissions"}),(0,n.jsx)("p",{className:"text-muted-foreground",children:"Manage system permissions"})]}),(0,n.jsx)(a.z,{onClick:()=>{z("add"),Z(""),B(""),q(null),P(!0)},className:"bg-[#6B46C1] hover:bg-[#5a3aa3]",children:"Add Permission"})]}),(0,n.jsxs)(l.Zb,{children:[(0,n.jsx)(l.Ol,{children:(0,n.jsx)(l.ll,{children:"All Permissions"})}),(0,n.jsx)(l.aY,{children:0===y.length?(0,n.jsx)("p",{children:"No permissions found."}):(0,n.jsx)("div",{className:"overflow-x-auto",children:(0,n.jsxs)(o.iA,{children:[(0,n.jsx)(o.xD,{children:(0,n.jsxs)(o.SC,{children:[(0,n.jsx)(o.ss,{className:"hidden md:table-cell",children:"ID"}),(0,n.jsx)(o.ss,{children:"Name"}),(0,n.jsx)(o.ss,{className:"hidden md:table-cell",children:"Description"}),(0,n.jsx)(o.ss,{children:"Actions"})]})}),(0,n.jsx)(o.RM,{children:y.map(e=>(0,n.jsxs)(o.SC,{className:"cursor-pointer",onClick:()=>K(e),children:[(0,n.jsx)(o.pj,{className:"hidden md:table-cell font-medium",children:e.id}),(0,n.jsx)(o.pj,{className:"font-medium",children:e.name}),(0,n.jsx)(o.pj,{className:"hidden md:table-cell max-w-[300px] truncate",children:e.description||"-"}),(0,n.jsx)(o.pj,{onClick:e=>e.stopPropagation(),children:(0,n.jsxs)("div",{className:"flex gap-2",children:[(0,n.jsx)(a.z,{variant:"outline",size:"sm",onClick:()=>$(e),children:"Edit"}),(0,n.jsx)(a.z,{variant:"destructive",size:"sm",onClick:()=>Y(e.id),children:"Delete"})]})})]},e.id))})]})})})]}),(0,n.jsx)(c.Vq,{open:C,onOpenChange:e=>{P(e),e||J()},children:(0,n.jsxs)(c.cZ,{children:[(0,n.jsx)(c.fK,{children:(0,n.jsx)(c.$N,{children:"add"===E?"Add New Permission":"Edit Permission"})}),(0,n.jsxs)("div",{className:"space-y-4",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)(h._,{children:"Permission Name"}),(0,n.jsx)(d.I,{placeholder:"Permission Name",value:D,onChange:e=>Z(e.target.value)})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)(h._,{children:"Description"}),(0,n.jsx)(m.g,{placeholder:"Permission Description",value:I,onChange:e=>B(e.target.value),rows:3})]})]}),(0,n.jsx)(c.cN,{children:(0,n.jsx)(a.z,{onClick:V,className:"bg-[#6B46C1] hover:bg-[#5a3aa3]",children:"add"===E?"Save Permission":"Update Permission"})})]})}),(0,n.jsx)(c.Vq,{open:_,onOpenChange:A,children:(0,n.jsxs)(c.cZ,{children:[(0,n.jsx)(c.fK,{children:(0,n.jsx)(c.$N,{children:"View Permission"})}),M&&(0,n.jsxs)("div",{className:"space-y-4",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)(h._,{className:"font-semibold",children:"ID:"}),(0,n.jsx)("p",{className:"text-sm",children:M.id})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)(h._,{className:"font-semibold",children:"Name:"}),(0,n.jsx)("p",{className:"text-sm",children:M.name})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)(h._,{className:"font-semibold",children:"Description:"}),(0,n.jsx)("p",{className:"text-sm",children:M.description||"N/A"})]})]}),(0,n.jsx)(c.cN,{children:(0,n.jsx)(a.z,{variant:"outline",onClick:()=>A(!1),children:"Close"})})]})})]})}):(0,n.jsx)(j.Z,{children:(0,n.jsx)(g.Z,{})})}},5771:function(e,s,i){"use strict";i.d(s,{g:function(){return a}});var n=i(7437),t=i(2265),r=i(9311);let a=t.forwardRef((e,s)=>{let{className:i,...t}=e;return(0,n.jsx)("textarea",{className:(0,r.cn)("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",i),ref:s,...t})});a.displayName="Textarea"}},function(e){e.O(0,[697,303,51,45,80,971,864,744],function(){return e(e.s=7648)}),_N_E=e.O()}]);